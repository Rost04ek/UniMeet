{% extends "base.html" %}

{% block title %}–ü–æ–¥—ñ—ó{% endblock %}

{% block content %}
<div class="container">
    <h1>UniMeet</h1>
    
    <div class="filters">
        <form method="GET" action="{{ url_for('events') }}" class="filter-form">
            <div class="form-group">
                <label for="status">–°—Ç–∞—Ç—É—Å:</label>
                <select name="status" id="status" onchange="this.form.submit()">
                    <option value="upcoming" {% if selected_status == 'upcoming' %}selected{% endif %}>–ú–∞–π–±—É—Ç–Ω—ñ</option>
                    <option value="ongoing" {% if selected_status == 'ongoing' %}selected{% endif %}>–ü–æ—Ç–æ—á–Ω—ñ</option>
                    <option value="completed" {% if selected_status == 'completed' %}selected{% endif %}>–ó–∞–≤–µ—Ä—à–µ–Ω—ñ</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="category">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:</label>
                <select name="category" id="category" onchange="this.form.submit()">
                    <option value="">–í—Å—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</option>
                    {% for category in categories %}
                        <option value="{{ category.id }}" {% if selected_category == category.id|string %}selected{% endif %}>
                            {{ category.name }}
                        </option>
                    {% endfor %}
                </select>
            </div>
        </form>
    </div>
    
    {% if events %}
        <div class="events-list">
            {% for event in events %}
                <div class="event-card-large">
                    <div class="event-header">
                        <div>
                            <span class="event-category">{{ event.category_name }}</span>
                            <h3>{{ event.title }}</h3>
                        </div>
                        <span class="event-status status-{{ event.status }}">{{ event.status|translate_status }}</span>
                    </div>
                    
                    <p class="event-description">{{ event.description[:200] }}...</p>
                    
                    <div class="event-details">
                        <div class="detail-item">
                            <strong>üìÖ –î–∞—Ç–∞:</strong> {{ event.event_date.strftime('%d.%m.%Y %H:%M') }}
                        </div>
                        <div class="detail-item">
                            <strong>üìç –ú—ñ—Å—Ü–µ:</strong> {{ event.location }}
                        </div>
                        <div class="detail-item">
                            <strong>üë§ –û—Ä–≥–∞–Ω—ñ–∑–∞—Ç–æ—Ä:</strong> {{ event.organizer_name }}
                        </div>
                        <div class="detail-item">
                            <strong>üë• –£—á–∞—Å–Ω–∏–∫–∏:</strong> {{ event.current_participants }}/{{ event.max_participants }}
                        </div>
                    </div>
                    
                    <div class="event-actions">
                        <a href="{{ url_for('event_detail', event_id=event.id) }}" class="btn btn-primary">–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ</a>
                        {% if session.role == 'admin' or (session.user_id and event.organizer_id == session.user_id) %}
                            <a href="{{ url_for('edit_event', event_id=event.id) }}" class="btn btn-secondary">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
                            <a href="{{ url_for('event_participants', event_id=event.id) }}" class="btn btn-info">–£—á–∞—Å–Ω–∏–∫–∏</a>
                            <form method="POST" action="{{ url_for('delete_event', event_id=event.id) }}" onsubmit="return confirm('–í–∏–¥–∞–ª–∏—Ç–∏ —Ü—é –ø–æ–¥—ñ—é?');" style="display:inline-block;">
                                <button type="submit" class="btn btn-danger">–í–∏–¥–∞–ª–∏—Ç–∏</button>
                            </form>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-center">–ü–æ–¥—ñ–π –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</p>
    {% endif %}
</div>
{% endblock %}
